# HS300 æ™ºèƒ½é€‰è‚¡ç³»ç»Ÿ - å¿«é€Ÿå¼€å§‹ (v1.1)

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

è‡ªåŠ¨åŒ–ä»æ²ªæ·±300æˆåˆ†è‚¡ä¸­ç­›é€‰ä¼˜è´¨æ ‡çš„ï¼Œå¹¶æä¾›ç­‰æƒä»“ä½é…ç½®å»ºè®®ã€‚

**æ ¸å¿ƒæµç¨‹**ï¼š
1. è·å– HS300 æˆåˆ†è‚¡åˆ—è¡¨ï¼ˆ283åªï¼Œå¸¦7å¤©ç¼“å­˜ï¼‰
2. æ‰¹é‡ä¸‹è½½å†å²æ•°æ®ï¼ˆå¸¦æ–­ç‚¹ç»­ä¼ +é‡è¯•æœºåˆ¶ï¼‰
3. åº”ç”¨åŠ¨é‡ç­–ç•¥ç­›é€‰ï¼ˆ20æ—¥æ¶¨å¹…>0%, MA5>MA10ï¼‰
4. ç­‰æƒåˆ†é…ä»“ä½ï¼ˆé¢„ç®—å¯é…ç½®ï¼Œè‡ªåŠ¨å–æ•´æ‰‹æ•°ï¼‰
5. è¾“å‡º JSON ç»“æœï¼ˆå«å…ƒæ•°æ®å’Œgitè¿½è¸ªï¼‰

## ğŸ†• v1.1 æ”¹è¿›

- âœ… **é»˜è®¤é¢„ç®—è°ƒæ•´ä¸º10ä¸‡å…ƒ**ï¼ˆç¬¦åˆå®é™…åœºæ™¯ï¼Œå¼€ç®±å³ç”¨ï¼‰
- âœ… **é¢„ç®—åˆç†æ€§æ ¡éªŒ**ï¼ˆä½äº2ä¸‡å…ƒç«‹å³æŠ¥é”™ï¼Œé¿å…é™é»˜å¤±è´¥ï¼‰
- âœ… **é€æ˜åŒ–ä¸å¯è´Ÿæ‹…ä¿¡æ¯**ï¼ˆæ˜ç¡®æ˜¾ç¤ºå“ªäº›è‚¡ç¥¨å› é¢„ç®—ä¸è¶³è¢«æ’é™¤ï¼‰
- âœ… **æ“ä½œå»ºè®®è¾“å‡º**ï¼ˆæç¤ºå¢åŠ é¢„ç®—é‡‘é¢æˆ–é™ä½é€‰è‚¡æ•°é‡ï¼‰

## ğŸš€ å¿«é€Ÿä½¿ç”¨

### åŸºç¡€å‘½ä»¤

```bash
# æ ‡å‡†ç”¨æ³•ï¼ˆ10ä¸‡é¢„ç®—ï¼Œé€‰5åªè‚¡ç¥¨ï¼‰
python scripts/hs300_selector.py --budget 100000 --top 5

# ä»…é€‰3åªï¼ˆæ›´ä¿å®ˆï¼‰
python scripts/hs300_selector.py --budget 100000 --top 3

# è·³è¿‡ä¸‹è½½ï¼ˆå‡è®¾æ•°æ®å·²å­˜åœ¨ï¼‰
python scripts/hs300_selector.py --budget 100000 --top 5 --skip-download

# å¼ºåˆ¶åˆ·æ–°æˆåˆ†è‚¡åˆ—è¡¨
python scripts/hs300_selector.py --budget 100000 --top 5 --force-refresh
```

### å‚æ•°è¯´æ˜

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `--budget` | 100000 | æ€»é¢„ç®—ï¼ˆå…ƒï¼‰ |
| `--top` | 5 | å€™é€‰æ± å¤§å°ï¼šä»ç­›é€‰ç»“æœä¸­å–å‰Nåï¼ˆå®é™…æŒä»“â‰¤Nï¼Œå—é¢„ç®—çº¦æŸï¼‰ |
| `--momentum-threshold` | 0.0 | 20æ—¥æ¶¨å¹…é˜ˆå€¼ï¼ˆç™¾åˆ†æ¯”ï¼‰ |
| `--skip-download` | False | è·³è¿‡æ•°æ®ä¸‹è½½ |
| `--force-refresh` | False | å¼ºåˆ¶åˆ·æ–°HS300æˆåˆ†è‚¡ |

## ğŸ“Š è¾“å‡ºè¯´æ˜

### æ§åˆ¶å°è¾“å‡º

```
============================================================
HS300 æ™ºèƒ½é€‰è‚¡ç³»ç»Ÿ - MVPç‰ˆæœ¬
============================================================
é¢„ç®—: 100000.0å…ƒ | å€™é€‰æ•°: 5åª | åŠ¨é‡é˜ˆå€¼: 0.0%
============================================================
âœ“ è·å– 283 åª HS300 æˆåˆ†è‚¡

============================================================
Top 5 å€™é€‰è‚¡ç¥¨ï¼ˆæŒ‰20æ—¥æ¶¨å¹…æ’åºï¼‰:
============================================================
1. 002475.SZ	ç«‹è®¯ç²¾å¯†    	æ¶¨å¹…: 49.84%	ä»·æ ¼:2170.64
2. 300750.SZ	å®å¾·æ—¶ä»£    	æ¶¨å¹…: 31.25%	ä»·æ ¼:762.80
3. 002920.SZ	å¾·èµ›è¥¿å¨    	æ¶¨å¹…: 21.39%	ä»·æ ¼:153.00
4. 600031.SH	ä¸‰ä¸€é‡å·¥    	æ¶¨å¹…: 10.01%	ä»·æ ¼:1026.45
5. 601012.SH	éš†åŸºè‚¡ä»½    	æ¶¨å¹…:  9.51%	ä»·æ ¼:377.10

============================================================
ğŸ“Š æŒä»“å»ºè®®ï¼ˆç­‰æƒåˆ†é…ï¼‰:
============================================================
  002920.SZ	å¾·èµ›è¥¿å¨    	1æ‰‹	æˆæœ¬:15300.00å…ƒ	å æ¯”:15.3%
------------------------------------------------------------
  æ€»æˆæœ¬: 15300.00å…ƒ
  é¢„ç®—åˆ©ç”¨ç‡: 15.3%
  å‰©ä½™: 84700.00å…ƒ

============================================================
âš ï¸ å› é¢„ç®—ä¸è¶³è¢«æ’é™¤çš„è‚¡ç¥¨:
============================================================
  002475.SZ	ç«‹è®¯ç²¾å¯†	æ¶¨å¹…: 49.84%	ä»·æ ¼:2170.64	ç¼ºå£:197064å…ƒ
  300750.SZ	å®å¾·æ—¶ä»£	æ¶¨å¹…: 31.25%	ä»·æ ¼:762.80	ç¼ºå£:56280å…ƒ
  600031.SH	ä¸‰ä¸€é‡å·¥	æ¶¨å¹…: 10.01%	ä»·æ ¼:1026.45	ç¼ºå£:82645å…ƒ
  601012.SH	éš†åŸºè‚¡ä»½	æ¶¨å¹…:  9.51%	ä»·æ ¼:377.10	ç¼ºå£:17710å…ƒ

ğŸ’¡ å»ºè®®:
   1. å¢åŠ é¢„ç®— 353699 å…ƒå¯ä¹°å…¥å…¨éƒ¨4åª
   2. æˆ–é™ä½é€‰è‚¡æ•° --top 1
============================================================
```

### JSON è¾“å‡º

æ–‡ä»¶ä½ç½®ï¼š`results/hs300_selection_YYYYMMDD.json`

```json
{
  "selection_date": "2025-10-10",
  "strategy": "HS300åŠ¨é‡ç­–ç•¥",
  "parameters": {
    "budget": 100000.0,
    "top_n": 5,
    "momentum_threshold": 0.0
  },
  "constituents_count": 283,
  "selected_count": 8,
  "allocation": {
    "positions": [
      {
        "symbol": "002920.SZ",
        "name": "å¾·èµ›è¥¿å¨",
        "price": 153.0,
        "lots": 1,
        "shares": 100,
        "cost": 15300.0,
        "weight": 15.3,
        "return_20d": 21.39,
        "ma5": 152.062,
        "ma10": 146.772
      }
    ],
    "unaffordable": [
      {
        "symbol": "002475.SZ",
        "name": "ç«‹è®¯ç²¾å¯†",
        "price": 2170.64,
        "min_cost": 217064.0,
        "allocated_budget": 20000.0,
        "shortage": 197064.0,
        "return_20d": 49.84,
        "reason": "1æ‰‹éœ€217064å…ƒ > åˆ†é…20000å…ƒ"
      }
    ],
    "total_cost": 15300.0,
    "budget": 100000,
    "utilization": 15.3,
    "count": 1,
    "warning": "4åªå€™é€‰è‚¡ç¥¨å› é¢„ç®—ä¸è¶³è¢«æ’é™¤ (æ€»é¢„ç®—100000å…ƒ Ã· 5åª = 20000å…ƒ/åª)"
  },
  "top_candidates": [...],
  "_metadata": {
    "timestamp": "2025-10-10 09:47:32",
    "phase": "Phase 1 MVP",
    "version": "1.1.0",
    "git": {
      "commit": "320cb1e8",
      "branch": "phase8-20year-backtest"
    }
  }
}
```

## âš™ï¸ æŠ€æœ¯ç»†èŠ‚

### æ•°æ®æº

- **æˆåˆ†è‚¡åˆ—è¡¨**ï¼šAKShare `ak.index_stock_cons(symbol='000300')`
- **å†å²æ•°æ®**ï¼šAKShare `ak.stock_zh_a_hist(adjust="hfq")` **åå¤æƒ**
- **ç¼“å­˜æœºåˆ¶**ï¼šHS300æˆåˆ†è‚¡ç¼“å­˜7å¤©ï¼Œé¿å…é¢‘ç¹è¯·æ±‚

### ç­›é€‰ç­–ç•¥

```python
# æ¡ä»¶1: 20æ—¥æ¶¨å¹… > é˜ˆå€¼ï¼ˆé»˜è®¤0%ï¼‰
return_20d = (current_price - price_20d_ago) / price_20d_ago
if return_20d <= threshold:
    reject()

# æ¡ä»¶2: çŸ­æœŸå‡çº¿ > é•¿æœŸå‡çº¿
if MA5 <= MA10:
    reject()
```

### ä»“ä½åˆ†é…

```python
# ç­‰æƒåˆ†é… + å–æ•´æ‰‹æ•°ï¼ˆ1æ‰‹=100è‚¡ï¼‰
allocation_per_stock = budget / len(top_stocks)
lots = int(allocation_per_stock / price / 100)  # å‘ä¸‹å–æ•´
shares = lots * 100
cost = shares * price
```

## âš ï¸ é‡è¦è¯´æ˜

### ä»·æ ¼ä½¿ç”¨åå¤æƒæ•°æ®

å½“å‰ç‰ˆæœ¬ä½¿ç”¨**åå¤æƒä»·æ ¼**ï¼ˆhfqï¼‰ï¼Œä¸»è¦åŸå› ï¼š
1. **å›æµ‹ä¸€è‡´æ€§**ï¼šä¸å›æµ‹ç³»ç»Ÿä½¿ç”¨ç›¸åŒæ•°æ®æ ¼å¼
2. **è¶‹åŠ¿å‡†ç¡®æ€§**ï¼šå¤æƒåçš„Kçº¿æ›´èƒ½åæ˜ çœŸå®èµ°åŠ¿

**å½±å“**ï¼š
- ä»·æ ¼æ•°å€¼è¿œé«˜äºå®é™…äº¤æ˜“ä»·æ ¼
- å¯¼è‡´é¢„ç®—åˆ©ç”¨ç‡è¾ƒä½ï¼ˆå¦‚10ä¸‡å…ƒåªèƒ½ä¹°1-2åªï¼‰

**å®ç›˜å»ºè®®**ï¼š
- ä½¿ç”¨å®æ—¶è¡Œæƒ…æ¥å£è·å–å½“å‰çœŸå®ä»·æ ¼
- æˆ–è€…ä¿®æ”¹ `akshare-to-qlib-converter.py` ä½¿ç”¨ä¸å¤æƒä»·æ ¼ï¼ˆ`adjust=""`ï¼‰
- å½“å‰ç‰ˆæœ¬é€‚åˆç­–ç•¥éªŒè¯ï¼Œå®ç›˜éœ€è¦è°ƒæ•´

### æ–­ç‚¹ç»­ä¼ æœºåˆ¶

- è‡ªåŠ¨è·³è¿‡å·²ä¸‹è½½çš„è‚¡ç¥¨æ•°æ®
- ä¸‹è½½å¤±è´¥è‡ªåŠ¨é‡è¯•3æ¬¡ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
- å•åªè‚¡ç¥¨è¶…æ—¶é™åˆ¶120ç§’

## ğŸ“ˆ å…¸å‹å·¥ä½œæµ

### é¦–æ¬¡è¿è¡Œï¼ˆå®Œæ•´ä¸‹è½½ï¼‰

```bash
# Step 1: ä¸‹è½½ HS300 æˆåˆ†è‚¡æ•°æ®ï¼ˆéœ€è¦20-30åˆ†é’Ÿï¼‰
python scripts/hs300_selector.py --budget 100000 --top 5

# å¦‚æœä¸­æ–­ï¼Œé‡æ–°è¿è¡Œä¼šè‡ªåŠ¨ç»­ä¼ 
python scripts/hs300_selector.py --budget 100000 --top 5
```

### æ—¥å¸¸ä½¿ç”¨ï¼ˆå·²æœ‰æ•°æ®ï¼‰

```bash
# è·³è¿‡ä¸‹è½½ï¼Œç›´æ¥ç­›é€‰
python scripts/hs300_selector.py --budget 100000 --top 3 --skip-download

# è°ƒæ•´é˜ˆå€¼ï¼ˆé€‰æ‹©æ›´å¼ºåŠ¿çš„è‚¡ç¥¨ï¼‰
python scripts/hs300_selector.py --budget 100000 --top 5 --momentum-threshold 5.0 --skip-download
```

### å®šæœŸç»´æŠ¤

```bash
# æ¯æœˆåˆ·æ–°æˆåˆ†è‚¡åˆ—è¡¨
python scripts/hs300_selector.py --budget 100000 --top 5 --force-refresh
```

## ğŸ“‚ æ–‡ä»¶ç»“æ„

```
Stock/
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ hs300_selector.py          # ä¸»ç¨‹åºï¼ˆæœ¬æ¬¡å¼€å‘ï¼‰
â”‚   â”œâ”€â”€ akshare-to-qlib-converter.py  # å•åªè‚¡ç¥¨ä¸‹è½½å™¨
â”‚   â””â”€â”€ batch_download.py          # æ‰¹é‡ä¸‹è½½å·¥å…·
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ io.py                      # å·¥å…·å‡½æ•°ï¼ˆJSONä¿å­˜ã€gitè¿½è¸ªï¼‰
â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ hs300_constituents.json    # HS300æˆåˆ†è‚¡ç¼“å­˜
â”‚   â””â”€â”€ hs300_selection_*.json     # é€‰è‚¡ç»“æœ
â””â”€â”€ ~/.qlib/qlib_data/cn_data/     # è‚¡ç¥¨æ•°æ®CSVæ–‡ä»¶
```

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šè·å–æˆåˆ†è‚¡å¤±è´¥

```bash
# é”™è¯¯ï¼šâŒ è·å– HS300 æˆåˆ†è‚¡å¤±è´¥
# åŸå› ï¼šç½‘ç»œé—®é¢˜æˆ–AKShareæ¥å£é™æµ
# è§£å†³ï¼šç¨åé‡è¯•ï¼Œæˆ–æ‰‹åŠ¨æŒ‡å®šæˆåˆ†è‚¡åˆ—è¡¨
```

### é—®é¢˜2ï¼šéƒ¨åˆ†è‚¡ç¥¨ä¸‹è½½å¤±è´¥

```bash
# ç°è±¡ï¼šä¸‹è½½ç»Ÿè®¡æ˜¾ç¤ºå¤±è´¥Nåª
# åŸå› ï¼šæ•°æ®æºä¸ç¨³å®šæˆ–è‚¡ç¥¨å·²é€€å¸‚
# å½±å“ï¼šä¸å½±å“ç­›é€‰ï¼Œä¼šè‡ªåŠ¨è·³è¿‡
# è§£å†³ï¼šå¯æ‰‹åŠ¨é‡è¯•å¤±è´¥çš„è‚¡ç¥¨
```

### é—®é¢˜3ï¼šæ— ç¬¦åˆæ¡ä»¶çš„è‚¡ç¥¨

```bash
# ç°è±¡ï¼šç­›é€‰ç»“æœ0åª
# åŸå› ï¼šå¸‚åœºæ•´ä½“èµ°å¼±ï¼Œæ— è‚¡ç¥¨æ»¡è¶³åŠ¨é‡æ¡ä»¶
# å»ºè®®ï¼šé™ä½momentum-thresholdæˆ–ç©ºä»“è§‚æœ›
```

## ğŸ¯ éªŒæ”¶æ ‡å‡†

- [x] æˆåŠŸè·å–HS300æˆåˆ†è‚¡åˆ—è¡¨ï¼ˆ283åªï¼‰
- [x] æ‰¹é‡ä¸‹è½½æ”¯æŒæ–­ç‚¹ç»­ä¼ å’Œé‡è¯•
- [x] ç­›é€‰å‡º3-5åªç¬¦åˆåŠ¨é‡æ¡ä»¶çš„è‚¡ç¥¨
- [x] ç­‰æƒåˆ†é…ä»“ä½ï¼ˆæ€»é¢„ç®—â‰¤è®¾å®šå€¼ï¼‰
- [x] è¾“å‡ºç»“æœåˆ° `results/hs300_selection_{date}.json`
- [x] JSONåŒ…å«gitå…ƒæ•°æ®ï¼ˆcommit/branch/dirtyçŠ¶æ€ï¼‰

## ğŸ“ ä¸‹ä¸€æ­¥æ‰©å±•

1. **å®æ—¶ä»·æ ¼é›†æˆ**ï¼šæ¥å…¥å®æ—¶è¡Œæƒ…APIæ›¿æ¢å¤æƒä»·æ ¼
2. **å¹¶è¡Œä¸‹è½½ä¼˜åŒ–**ï¼šä½¿ç”¨å¤šçº¿ç¨‹åŠ é€Ÿä¸‹è½½ï¼ˆå½“å‰ä¸²è¡Œï¼‰
3. **å¢é‡æ›´æ–°**ï¼šä»…æ›´æ–°æœ€æ–°äº¤æ˜“æ—¥æ•°æ®ï¼ŒèŠ‚çœæµé‡
4. **Virtual Portfolioé›†æˆ**ï¼šè‡ªåŠ¨åˆ›å»ºè™šæ‹ŸæŒä»“è·Ÿè¸ª
5. **å¼¹æ€§æƒé‡**ï¼šæ”¯æŒåŠ¨æ€æƒé‡åˆ†é…ï¼ˆéç­‰æƒï¼‰

---

**ç‰ˆæœ¬**ï¼šv1.1.0 MVP
**å¼€å‘æ—¶é—´**ï¼š2025-10-10
**ä½œè€…**ï¼šClaude Code
**Git**: phase8-20year-backtest @ 320cb1e8
